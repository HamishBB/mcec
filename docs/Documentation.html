<div class="wikidoc">
<h1>MCE Controller Documentation</h1>
<p>Copyright © 2014 <a href="http://www.kindel.com">Kindel Systems</a>, LLC. Licensed under the
<a href="http://mcec.codeplex.com/license" target="_blank">MIT License</a>.</p>
<p>By Charlie Kindel (<a href="http://www.twitter.com/ckindel">@ckindel on Twitter</a>)</p>
<h2>Overview</h2>
<p><strong>MCE Controller</strong> lets you control a Windows HTPC (or any PC) over the network. It runs in the background listening on the network (or serial port) for commands. It then translates those commands into actions such as keystrokes, text input,
 and the starting of programs. Any remote control, home control system, or application that can send text strings via TCP/IP or a serial port can use
<strong>MCE Controller</strong> to control a Windows PC.</p>
<p>For example:</p>
<ul>
<li>The command <code>mcestart</code> will cause the Windows Media Center application to start. This is equivalent to pressing the green button on the Windows remote control.
</li><li>The command <code>maximize</code> will cause the current window to be maximized on the display. This is equivalent to choosing the &quot;Maximize&quot; button on the window's window menu.
</li><li>The command <code>chars:Hello World!</code> will cause the text &quot;Hello World&quot; to be typed, as though it were typed on the keyboard.
</li><li>The command <code>VK_MEDIA_NEXT_TRACK</code> will cause the currently running media player app (Spotify, Windows Media Player, etc...) to jump to the next media track, just as if the user had pressed th &quot;next track&quot; key on the keyboard.
</li><li>The commands that <strong>MCE Controller</strong> support is extensible through a configuration file. If it does not natively support a function you wish, you can add new commands easily.
</li></ul>
<p><strong>MCE Controller</strong> was initially developed to enable integration of a Windows Media Center based home theater PC (HTPC) into a Crestron whole-house audio/video system. However, it is general enough that others have used it within other control
 system that support sending text strings to a TCP/IP port. Most control systems, such as Crestron or AMX, support IR emitting.</p>
<p>For many applications, emitting the Media Center IR commands will suffice. However, for some installations the reliability of IR emitting and other factors may make IR emitting problematic and
<strong>MCE Controller</strong> offers a robust solution.</p>
<p><strong>MCE Controller</strong> can act as either a TCP/IP client or server. When acting as a client the target host and port can be configured. When acting as a server the incoming port can be configured.</p>
<p><strong>MCE Controller</strong> can also listen on an RS-232 serial port.</p>
<p><strong>MCE Controller</strong> can run showing only a taskbar icon. By double clicking on the taskbar a status window is displayed that shows a log of all activity. You can also right-click on the taskbar icon for a menu.</p>
<h2>Features</h2>
<ul>
<li>Can act as a TCP/IP client or server. Supports any number of simultaneous clients.&nbsp; Supports Telnet protocol.
</li><li>Can act as a serial server listening on RS-232 COM port. </li><li>Supports simulating key presses (e.g. Alt-Tab, or Win-S) with <code>SendInput</code> commands.
</li><li>Supports simulating the mouse. </li><li>Supports simulating Windows messages (e.g. <code>WM_SYSCOMMAND</code> / <code>
SC_MAXIMIZE</code>) with <code>SendMessage</code>commands. </li><li>Supports simulating start process commands (e.g. run <code>notepad.exe</code>) with the
<code>StartProcess</code>command. </li><li>Supports simulating changing the window focus with the <code>SetForegroundWindow</code> command.
</li><li>Supports sending text (e.g. simulating typing) with the <code>chars:</code> command.
</li><li>Includes built-in support for common Windows Media Center commands. It can easily be extended to suit your needs through a
<code>MCEController.commands file.</code> </li><li>Supports running multiple instances. </li><li>Can start minimzed as a taskbar icon. This can be changed in Settings... </li><li>Has a built-in test mode that makes it easy to send commands from an instance of MCE Controller to another. \
</li><li>Automatically checks to see if newer versions are available. </li><li>Logs diagnostics information to a file. </li></ul>
<h2>Installation</h2>
<p>Important Note: <strong>MCE Controller</strong> requires the .NET Framework 4.5. Go to
<a href="http://www.microsoft.com/net">http://www.microsoft.com/net</a> to ensure you have this installed before running
<strong>MCE Controller</strong>.</p>
<p>To install, simply run the <code>MCEController 1.x.x Setup.exe</code> to install. The following files will be installed in the directory you choose and a start menu item will be added. You can un-install
<strong>MCE Controller</strong> either via add/remove programs or by using the uninstall icon in the
<strong>MCE Controller</strong> start menu group.</p>
<ul>
<li><code>MCEControl.exe</code> </li><li><font face="monospace">HtmlAgilityPack.dll</font> </li></ul>
<p>When <strong>MCE Controller</strong> runs, it defaults to showing itself as only a taskbar icon. Double clicking on the taskbar icon will show the configuration/status window.</p>
<p>If you would like it to show it’s configuration/status window upon startup, uncheck the
<em>Hide Window at Startup </em>checkbox in the settings dialog.</p>
<h2>Settings</h2>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811479"><img title="Settings" border="0" alt="Settings" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811480" width="244" height="230" style="border-left-width:0px; border-right-width:0px; border-bottom-width:0px; padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-top-width:0px"></a></p>
<p>Configuration settings are stored in a file that will be created in the <code>
%APPDATA%\Roaming\Kindel Systems\MCE Controller</code> directory when MCE Controller is first run. The configuration settings file is named
<code>MCEControl.settings</code>.</p>
<p>You can run multiple instances of MCE Controller. To do so simply copy the EXE to a 2nd directory. Each copy will then have its own independent
<code>MCEControl.settings</code> file.</p>
<p>MCE Controller can act as either a TCP/IP client or server (it can actually operate as both simultaneously, which can be useful for testing, but not much else). By default MCE Controller is configured to act as a TCP/IP server listening on port 5150. You
 can change this behavior using the Settings dialog described below.</p>
<h2>The Client Tab</h2>
<p>The Client tab in the Settings dialog controls <strong>MCE Controller’s</strong> TCP/IP client functionality. When acting as a client,
<strong>MCE Controller</strong> will repeatedly try to connect to the specified port on the specified host and wait for commands to be sent from the host.
<strong>MCE Controller</strong> sends nothing to the host.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811481"><img title="Client" border="0" alt="Client" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811482" width="244" height="230" style="border-left-width:0px; border-right-width:0px; border-bottom-width:0px; padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-top-width:0px"></a></p>
<ul>
<li>Enable Client. This checkbox enables or disables the TCP/IP client functionality. If enabled, the followings settings apply:
</li><li>Host. This is the IP address or host name of the server<strong> MCE Controller</strong> is to connect to.
</li><li>Port. This is the port that <strong>MCE Controller</strong> will connect to. </li><li>Reconnect Wait Time. This is the number of milliseconds (default is 30 seconds or 30000 ms)
<strong>MCE Controller</strong> will wait before trying to reconnect to the host once a connection has been dropped or a connect fails.
</li><li>Show &quot;send command&quot; Window. If checked, whenever the client is connected a window will appear that will allow you to send commands to another instance (or even the same instance with Server turned on) of
<strong>MCE Controller</strong>. This is useful for testing that your server is working.
</li></ul>
<h2>The Server Tab</h2>
<p>The Server tab in the Settings dialog controls<strong> MCE Controller’s</strong> TCP/IP server functionality. When acting as a server,
<strong>MCE Controller</strong> will open the specified port and wait for a client to connect. When a client does connect
<strong>MCE Controller </strong>will wait for incoming commands until the client closes the connection.</p>
<p>In server mode, <strong>MCE Controller</strong> supports any number of multiple-simultaneous connections.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811483"><img title="Server" border="0" alt="Server" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811484" width="244" height="230" style="border-left-width:0px; border-right-width:0px; border-bottom-width:0px; padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-top-width:0px"></a></p>
<ul>
<li>Enable Server. This checkbox enables or disables the TCP/IP server functionality. If enabled, the followings settings apply:
</li><li>Port. This is the port that <strong>MCE Controller</strong> will listen on. </li><li>Enable Wakeup. If enabled, <strong>MCE Controller</strong> will attempt to connect to the specified host/port, send the “Wakeup command” and disconnect when it first starts. When it shuts down it will send the “Closing command”. This functionality is useful
 when the remote client needs to be notified that <strong>MCE Controller</strong> is ready (for example after the server PC has rebooted).
</li></ul>
<h2>The Serial Server Tab</h2>
<p>The Serial Server tab in the Settings dialog controls <strong>MCE Controller’s</strong> serial port (RS-232) functionality. When the Serial Server is enabled,
<strong>MCE Controller</strong> will open the specified COM port (e.g. COM1) and wait commands to be sent.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811485"><img title="Serial" border="0" alt="Serial" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811486" width="244" height="230" style="border-left-width:0px; border-right-width:0px; border-bottom-width:0px; padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-top-width:0px"></a></p>
<ul>
<li>Enable Server. This checkbox enables or disables the Serial Server functionality. It is disabled by default. If enabled, the followings settings apply:
</li><li>Port. This is the serial port that <strong>MCE Controller</strong> will listen on (e.g. COM1).
</li><li>Baud Rate. Sets the speed of the serial port. </li><li>Data Bits, Parity, Stop Bits, and Handshake: Set the serial port configuration.
</li></ul>
<h2>Testing MCE Controller</h2>
<p><strong>MCE Controller</strong> includes a built in TCP/IP client that can send commands to another instance of
<strong>MCE Controller</strong> running on the same or different PC. You can even use the Client and Server within the same instance.</p>
<h3>Using the MCE Controller Client</h3>
<p>Check the <em>Show &quot;send command&quot; window</em> checkbox in the Client settings and as soon as
<strong>MCE Controller</strong> connects to a server instance the <em>Send Command</em> window will appear.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811487"><img title="Commands" border="0" alt="Commands" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=mcec&DownloadId=811488" width="244" height="225" style="border-left-width:0px; border-right-width:0px; border-bottom-width:0px; padding-top:0px; padding-left:0px; display:inline; padding-right:0px; border-top-width:0px"></a></p>
<h3>Using PUTTY</h3>
<p>PuTTY is a free terminal emulator (and Telnet and SSH client). It works well for testing MCE Controller. You can download
<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">PuTTY here</a>.</p>
<h4>Using PUTTY to test TCP/IP interactions</h4>
<p><img alt="Using PUTTY over TCP/IP" src="http://i.imgur.com/PwXOX.png"></p>
<ol>
<li>Run PUTTY.EXE </li><li>Set <em>Host Name</em> to <em>localhost</em> (or the network name of the PC running MCE Controller
</li><li>Set <em>Port</em> to the port MCE Controller is set to listen on (e.g. 5150) </li><li>Set the <em>Connection Type</em> to <em>Raw</em>. </li><li>Click <em>Open</em> </li></ol>
<p>Type commands in the PuTTY Window and see how MCE Controller reacts.</p>
<h4>Using PUTTY to test serial connections</h4>
<p>PuTTY supports connecting via serial ports. The usage is the same as in the TCP/IP example above except you set the appropriate COM port settings in PuTTY and choose the
<em>Serial</em> destination type.</p>
<h2>Commands</h2>
<p>MCE Controller works with <strong>Commands</strong>. Commands are text strings like
<code>greenbutton</code>, <code>hibernate</code>, and <code>winkey</code>. Each command has a
<strong>Type</strong>. When<strong> MCE Controller</strong> receives a command it causes an action to happen on the PC it is running on. The action taken is dependent on the type of command and the parameters set for that command.</p>
<p>The following command types are supported by <strong>MCE Controller</strong>:</p>
<ul>
<li><strong>StartProcess</strong> - Starts the specified process. Can specify the path to an executable, shortcut, or a URI. Supports embedded
<code>nextCommand</code> elements allowing other form of MCE Controller commands to be invoke after the process starts.
</li><li><strong>SetForgroundWindow</strong> - Causes the specified window to be brought to the foreground.
</li><li><strong>Shutdown</strong> - Allows the host computer to be shutdown, restarted, put in standby, or hibernate mode.
</li><li><strong>SendMessage</strong> - Enables the sending of window messages to windows. E.g. the 'mcemaximize' command causes the Media Center window to go full screen.
</li><li><strong>SendInput</strong> - Sends keyboard input as though it were typed on a keyboard.
</li><li><strong>Mouse</strong> - Sends mouse movement and button actions. </li><li><strong>Built-In</strong> - Single characters, <code>VK_</code> codes, <code>
chars:</code>, <code>shiftdown:</code>, <code>shiftup:, </code>and<code> mcec:.</code>
</li></ul>
<p><strong>MCE Controller</strong> includes a set of pre-defined commands for controlling Windows Media Center as well as standard keyboard input. Pre-defined commands can be found in the built-in .commands file
<a href="https://mcec.codeplex.com/SourceControl/latest#Resources/MCEControl.commands" target="_blank">
here</a> (see the section titled “Defining Your Own Commands” below for instructions on how to change the commands
<strong>MCE Controller</strong> supports). </p>
<p><strong>MCE Controller</strong> commands are <em>not</em> case-sensitive. Thus
<code>VK_UP</code> is equivalent to <code>vk_up</code> and <code>shutdown</code> is equivalent to
<code>ShutDown</code>.</p>
<p>The following describes the Built-In commands that are supported:</p>
<h3>All Windows virtual key codes</h3>
<p>Any Windows virtual key code is supported by default. The form of the commands are
<code>VK_&lt;key name&gt;</code>. For example you can send <strong>MCE Controller</strong> any of the following commands and the corresponding key press will be simulated.</p>
<pre><code>VK_ESCAPE
VK_LWIN
VK_VOLUME_MUTE
VK_VOLUME_UP 
VK_MEDIA_PLAY_PAUSE
VK_F1
</code></pre>
<p>If you want a keystroke that includes a shift modifier (e.g. <code>Win-D</code> or
<code>Ctrl-G</code>) you should define a custom <code>SendInput</code> command as described below.</p>
<p>You can find a list of all Window's virtual key codes on <a href="http://msdn.microsoft.com/en-us/library/dd375731.aspx">
this MSDN page</a></p>
<h3>Any single character</h3>
<p>This is equivalent to a single key press of a key on the keyboard. For example
<code>a</code> will result in the A key being pressed. <code>1</code> will result in the
<code>1</code> key being pressed. There is no difference between sending <code>a</code> and
<code>A</code>. Use <code>shiftdown:/shiftup:</code> to simulate the pressing of the shift, control, alt, and windows keys.</p>
<h3>Shiftdown/up Commands</h3>
<p>To simulate a key down event for one of the modifiers keys (shift, control, alt, and the Windows key) send a
<code>shiftdown:</code> or <code>shiftup:</code> command. The syntax is:</p>
<pre><code>shiftdown:[shift|ctrl|alt|lwin|rwin]
</code></pre>
<p>and</p>
<pre><code>shiftup:[shift|ctrl|alt|lwin|rwin]
</code></pre>
<p>For example, to simulate the typing of 'Test!' send the following commands:</p>
<pre><code>shiftdown:shift
t
shiftup:shift
e
s
t
shiftdown:shift
1
shiftup:shift
</code></pre>
<p>(Although, using a <code>chars:</code> command would probably work better in most cases).</p>
<p>This scheme can be used as an alternative way of sending ctrl-, alt-, and win- keystrokes. For example to simulate ctrl-s:</p>
<pre><code>shiftdown:ctrl
s
shiftup:ctrl 
</code></pre>
<h3>chars: Commands</h3>
<p>Anytime <strong>MCE Controller</strong> receives <code>chars:</code> plus some text, it simulates the typing of that text on the keyboard. The syntax of the command is
<code>chars:*</code> where '*'' represents one or more characters. This is equivalent to typing those characters on the keyboard. E.g.
<code>chars:3</code> will cause the number 3 to be typed as though the user had pressed the 3 key on the keyboard.
<code>chars:Hello</code> will cause <code>Hello</code> to be typed.</p>
<p>Unicode (and other escaped character sequences are supported). <code>chars:\u20AC</code> will cause the € character to be input into the foreground window on the machine
<strong>MCE Controller</strong> is running on.</p>
<p>NOTE: Older versions of MCE Controller supported a <code>keys:</code> command that purported to do the same thing. It never actually worked right and has been replaced with the new
<code>chars:</code> command.</p>
<h3>mouse: Commands</h3>
<p><strong>MCE Controller</strong> can simulate mouse movement. With this it is possible to build a remote control that acts like a mouse (I have built a test app for Windows Phone 7 that enables WP7 to work like a touchpad; contact me if you are interested
 in it).</p>
<p>The general format of the mouse commands is:</p>
<pre><code>mouse:&lt;action&gt;[,&lt;param&gt;,...,&lt;param&gt;]
</code></pre>
<p>The available mouse actions are:</p>
<ul>
<li><strong>lbc</strong> - Left button click (<code>mouse:lbc</code>) </li><li><strong>lbdc</strong> - Left button double-click (<code>mouse:lbdc</code>) </li><li><strong>lbd</strong> - Left button down (<code>mouse:lbd</code>) </li><li><strong>lbu</strong> - Left button up (<code>mouse:lbu</code>); </li><li><strong>rbc, rbdc, rbd, rbu</strong> - Same same but for the right mouse button.
</li><li><strong>xbc, etc...</strong> - x button click where x is a button number (<code>mouse:xbc,3</code> for button 3 click)
</li><li><strong>mm,x,y</strong> - Move the mouse x, y pixels (<code>mouse:mm,7,-3</code> would move the mouse right 7 and up 3 pixels)
</li><li><strong>mt,x,y</strong> - Move the mouse to a location. The coordinates represent the absolute X/Y-coordinates on the primary display device where 0 is the extreme left/bottom of the display device and 65535 is the extreme right/bottom hand side of the
 display device (<code>mouse:mt,0,65535</code> would move the mouse to the bottom left corner of the primary display).
</li><li><strong>mtv,x,y</strong> - Move the mouse to a location on the virtual desktop. The coordinates represent the absolute X/Y-coordinates on the virtual desktop where 0 is the extreme left/top of the virtual desktop and 65535 is the extreme right/bottom (<code>mouse:mtv,65535,0</code>
 would move the mouse to the top right corner of the virtual desktop). </li><li><strong>hs,n</strong> - Simlate a horizontal scroll gesture. <code>n</code> is the amount to scroll in clicks. A positive value indicates that the wheel was rotated to the right; a negative value indicates that the wheel was rotated to the left (<code>mouse:hs,3</code>).
</li><li><strong>vs,n</strong> - Simlate a vertical scroll gesture. <code>n</code> is the amount to scroll in clicks. A positive value indicates that the wheel was rotated forward, away from the user; a negative value indicates that the wheel was rotated backward,
 toward the user (<code>mouse:vs,3</code>). </li></ul>
<p>Note that when sending mouse movements it is best if the <strong>MCE Controller</strong> window is hidden as the display log tends to chew up a lot of resources, making things jerky.</p>
<h3>mcec: Commands</h3>
<p>The following commands control <strong>MCE Controller</strong> itself:</p>
<ul>
<li><strong>mcec:ver</strong> – Gets the version number. </li><li><strong>mcec:exit</strong> – Causes <strong>MCE Controller</strong> to exit. </li><li><strong>mcec:cmds</strong> – Lists all commands. </li></ul>
<p>Values returned by commands in <strong>MCE Controller</strong> are of the format “command=value” where command is the command to the left of the command prefix (mcec:).</p>
<h2>Defining Your Own Commands</h2>
<p>MCE Controller has a set of over 250 built-in commands. You can see how they are defined
<a href="https://mcec.codeplex.com/SourceControl/latest#Resources/MCEControl.commands" target="_blank">
here</a>. You can override or augment this set by creating a file named <code>MCEControl.commands</code> file and putting it in the same directory as the program executable.
</p>
<p>In previous versions the default commands were stored in a file named <code>MCEControl.commands</code> and MCE Controller required this file to be present to work. As of version 8.4, the default commands are built-in to the program itself.
<code>MCEControl.commands</code> is still supported, but is optional. If a <code>
MCEControl.commands</code> file is found in the working directory when MCE Controller starts any commands it defines will add to and over-ride matching built-in commands.</p>
<p>Create a new file named MCEControl.commands and put it in the same directory as the MCE Controller EXE file.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;MCEController xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;
&lt;Commands xmlns=&quot;http://www.kindel.com/products/mcecontroller&quot;&gt;
&lt;!-- Place command definitions here --&gt;
&lt;/Commands&gt;
&lt;/MCEController&gt;</code></pre>
<code>MCEControl.commands</code> allows you to define four types of commands: <code>
SendInput</code>, <code>SendMessage</code>, <code>StartProcess</code>, <code>Shutdown</code>, and
<code>SetForegroundWindow</code>.
<p><strong>Note on case sensitivity</strong>: In the <code>MCEControl.commands</code> file, all XML element and attribute names are case-sensitive. E.g. ‘ctrl’ is NOT the same as ‘Ctrl’.&nbsp; The commands themselves (the values of Cmd attributes) are NOT case-sensitive.
 E.g. ‘MonitorOff’ will be treated the same as ‘monitoroff’.</p>
<h3>SendInput Commands</h3>
<p><code>SendInput</code> commands send keystrokes. Any combination of shift, ctrl, alt, and left/right Windows keys can be used with any &quot;virtual key code&quot;. See the
<code>winuser.h</code> file in the Windows SDK or <a href="http://msdn.microsoft.com/en-us/library/dd375731.aspx">
this MSDN page</a> for a definition of all standard <code>VK_</code> codes. <strong>
MCE Controller</strong> understands key codes in hex (e.g. <code>0x2a</code>) or decimal format, or as a
<code>VK_</code> name. <strong>MCE Controller</strong> uses the Windows <code>SendInput()</code> API to send keystrokes. Keystrokes go to the foreground window.</p>
<p>For example, the following causes a Ctrl-P to be sent to the foreground window, and if that window is Media Center, the My Pictures page appears:</p>
<pre><code> &lt;SendInput Cmd=&quot;mypictures&quot; vk=&quot;73&quot; Shift=&quot;false&quot; Ctrl=&quot;true&quot; Alt=&quot;false&quot; /&gt;
</code></pre>
<p>(The VK code or 'P' is 73 decimal).</p>
<p>This example causes a Windows-X to be simulated, which causes the Windows 8 &quot;expert&quot; menu to pop up:</p>
<pre><code> &lt;SendInput Cmd=&quot;winx&quot; vk=&quot;VK_X&quot; Win=&quot;true&quot;/&gt;
</code></pre>
<h3>SendMessage Commands</h3>
<p><code>SendMessage</code> commands are just that. They cause <strong>MCE Controller</strong> to send a Windows message using the
<code>SendMessage()</code> API to the foreground window if no class name is specified, or to a particular window if that window’s class is specified.
<code>Msg</code>, <code>wParam</code>, and <code>lParam</code> must be specified in decimal (not hex!).</p>
<p>For example, the following is equivalent to sending a <code>WM_SYSCOMMAND</code> with the
<code>SC_MAXIMIZE</code> flag, causing the window with the class name of <code>ehshell</code> to be maximized (<code>WM_SYSCOMMAND == 247</code> and
<code>SC_MAXIMIZE == 61488</code>):</p>
<pre><code>&lt;SendMessage Cmd=&quot;mce_maximize&quot; ClassName=&quot;ehshell&quot; Msg=&quot;274&quot; wParam=&quot;61488&quot; lParam=&quot;0&quot; /&gt;
</code></pre>
<p>These commands might be useful in some scenarios:</p>
<pre><code>&lt;!--      WM_SYSCOMMAND, SC_SCREENSAVE                                 --&gt;
&lt;SendMessage Cmd=&quot;screensaver&quot; Msg=&quot;274&quot; wParam=&quot;61760&quot; lParam=&quot;0&quot; /&gt;
&lt;!--      WM_SYSCOMMAND, SC_MONITORPOWER, 2 = off, -1 = on             --&gt;
&lt;SendMessage Cmd=&quot;monitoroff&quot; Msg=&quot;274&quot; wParam=&quot;61808&quot; lParam=&quot;2&quot; /&gt;
&lt;SendMessage Cmd=&quot;monitoron&quot; Msg=&quot;274&quot; wParam=&quot;61808&quot; lParam=&quot;-1&quot; /&gt;
</code></pre>
<p>See the <a href="http://msdn.microsoft.com/en-us/library/ms646360(v=VS.85).aspx">
MSDN documentation</a> for more <code>WM_SYSCOMMAND</code> possibilities.</p>
<h3>StartProcess Commands</h3>
<p><code>StartProcess</code> commands start processes. Process commands support chaining using the
<code>nextCommand </code>element. The embedded command will be executed after the started application starts processing windows’ messages.</p>
<p>For example, the following launches Media Center and maximizes it:</p>
<pre><code>&lt;StartProcess Cmd=&quot;mce_start&quot; File=&quot;C:\windows\ehome\ehshell.exe&quot;&gt;
    &lt;nextCommand xsi:type=&quot;SendMessage&quot; ClassName=&quot;ehshell&quot; Msg=&quot;274&quot; wParam=&quot;61488&quot; lParam=&quot;0&quot; /&gt;
&lt;/StartProcess&gt;
</code></pre>
<h3>Shutdown Commands</h3>
<p>The supported shutdown commands are self-explanatory.</p>
<pre><code>&lt;Shutdown Cmd=&quot;shutdown&quot; Type=&quot;shutdown&quot;/&gt;
&lt;Shutdown Cmd=&quot;restart&quot; Type=&quot;restart&quot;/&gt;
&lt;Shutdown Cmd=&quot;abort&quot; Type=&quot;abort&quot;/&gt;
&lt;Shutdown Cmd=&quot;standby&quot; Type=&quot;standby&quot;/&gt;
&lt;Shutdown Cmd=&quot;hibernate&quot; Type=&quot;hibernate&quot;/&gt;
</code></pre>
<h3>SetForgroundWindow Commands</h3>
<p>The <code>SetForegroundWindow</code> command sets the specified window (using the window’s class name) to the foreground.</p>
<p>For example, the following makes Media Center the foreground Window (assuming Media Center is running):</p>
<pre><code>&lt;SetForegroundWindow Cmd=&quot;mce_activate&quot; ClassName=&quot;ehshell&quot;/&gt;
</code></pre>
<p>Note that <strong>MCE Controller</strong> supports the <code>chars:</code>, <code>
shiftup:</code>, and <code>shiftdown:</code> commands in addition to the commands defined in MCEControl.commands.</p>
<p>Also note that you should not make commands a single character or it will interfere with the ability to simulate individual character key presses.</p>
<h3>Disabling All Internal Commands</h3>
<p>You can force MCE Controller to only listen to and act on commands defined in the MCEControl.commands file. To do this use the Windows registry editor to create the
<code>HKEY_LOCAL_MACHINE\SOFTWARE\Kindel Systems\MCE Controller </code>registry key and set
<font face="Courier New">DisableInternalCommands</font> (a DWORD value) to anything other than 0.
</p>
<p>This will disable ALL internal commands.</p>
<p>This is a machine wide setting and will apply to all instances of MCE Controller.
</p>
<h2>Logging</h2>
<p>All information shown in the main window is also logged to a file to ease diagnostics. If the program is started from the default location (in Program Files) the log will be written to %LocalAppData%\Kindel Systems\MCE Controller\MCEControl.log. Otherwise
 the log will be written to the directory the program is started from.</p>
<h2>Usage Notes</h2>
<p>The <code>mcestart</code> command will launch Media Center and cause it to be maximized. If you do not want this behavior, change
<code>MCEControl.commands</code> such that the <code>mcestart</code> command does not have the embedded
<code>nextCommand</code> element.</p>
<p>For <strong>MCE Contoller</strong> to work property the target application (Media Center) must be the active window (foreground) on the desktop. You can use the
<code>mceactivate</code> command to cause Media Center to be the foreground app if it’s already running. Alternatively you can just use
<code>mcestart</code> as it will end up causing the same thing to happen (although not as quickly).</p>
<p>Also, you may find that <code>greenbutton</code> is a better function than <code>
mcestart</code> because it is equivalent to the green-button on a Windows remote control.
<code>mcestart</code> is a bit different because if Media Center is already running
<code>mcestart</code> will not go to the &quot;Start&quot; screen of Media Center while <code>
greenbutton</code> will. However, <code>greenbutton</code> does not cause the Media Center window to be maximized.</p>
<h1>Version History</h1>
<ul>
<li>Version 1.0.1 (February 22, 2004) – First publicly released version. </li><li>Version 1.0.2 (March 24, 2004) - New features: Added support for system shutdown, restart, standby, and hibernate (the Shutdown command type). Renamed a few commands (&quot;mce_start&quot; is now &quot;mcestart&quot; for example) to be more consistent.
</li><li>Version 1.0.3 (March 26, 2004) - Added installer. </li><li>Version 1.0.4 (February 26, 2005) - Fixed bug that caused MCE Controller to prevent logoffs and shutdowns.
</li><li>Version 1.0.5 (April, 2005) – Added support for arbitrary # of characters for the “key:” command.
</li><li>Version 1.1.0 (May 11, 2005) – No functional changes. Changed the source license to the BSD license and posted on Sourceforge.
</li><li>Version 1.3.0 (January 3, 2012) – Added support for &quot;chars:&quot;. Removed support for &quot;keys:&quot;. Added &quot;enter&quot; command. Now builds with VS2010.
</li><li>Version 1.3.1 (January 4, 2012) – Fixed bug parsing -1 in the lParam of SendMessageCommands. Commented MCEController.commands. Minor code cleanup.
</li><li>Version 1.3.2 (January 4, 2012) – Fixed bug in how .commands and .settings are stored (Win7 broke permissions).
</li><li>Version 1.3.3 (January 9, 2012) – Added capability to send individual key presses with shift/ctrl/alt/win modifiers (what keys: originally was supposed to do).
</li><li>Version 1.4.0 (February 11, 2012) - Server now supports any number of client connections. Expanded MCEController.commands to include commands used by iRule (http://iruleathome.com). Updated About Box &amp; Help menu to reflect move to GitHub. Added menu
 item to open directory containing MCEController.commands. </li><li>Version 1.5.0 (March 27, 2012) - 'chars:' command now supports escaped characters. This allows the sending of Unicode characters such as € (e.g. 'chars:\u20AC' will cause the € character to be input on the server machine).
</li><li>Version 1.5.1 (April 2, 2012) - Removed readme file from distribution and updated online docs.
</li><li>Version 1.5.2 (October, 4, 2012) - Fixed .settings file bug where it would sometimes read from Program Files and write to AppData. Now always writes to AppData unless started outside of Program Files. Fixed Setting dialog to be more resilient to bad data.
 Fixed Send Awake so that it does not fault on bad data, but logs errors. General code clean up. Built with VS2012.
</li><li>Version 1.6.0 (October 10, 2012) - Added mouse simulation support. </li><li>Version 1.6.1 (November 6, 2012) - Fixed bug with some Telnet clients that don't buffer each line before sending.
</li><li>Version 1.7.0 (December 19, 2012) - Added Serial Server support. </li><li>Version 1.8.0 (December 30, 2012) - Added VK_ command support. Added 'command window'. New icon. Updated documentation.
</li><li>Version 1.8.1 (January 1, 2013) - Updated links for CodePlex. Fixed crashing bug on exit.
</li><li>Version 1.8.4 (March, 2014) - New icon by <a href="http://guillendesign.deviantart.com/">
http://guillendesign.deviantart.com/</a>, Minor menu tweaks, MCEControl.commands is now an optional file. The previously defined set of commands from older builds are now built into the program. If a MCEControl.commands file is present it will add to and override
 these pre-defined commands. Upgrades and un-installs will no longer overwrite or delete the MCEControl.commands file.
</li><li>Version 1.8.6 (May, 2014) – Internal commands can be disabled via a registry key. Fixed bug when client forcibly closed socket. Added logging.</li></ul>
</div><div class="ClearBoth"></div>